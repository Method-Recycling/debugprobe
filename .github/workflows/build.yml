name: Build & Archive Firmware on Push

on: [push]

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
        - uses: actions/checkout@v3

        - name: Set up Python
          uses: actions/setup-python@v4
          with:
            python-version: 3.x

        - name: Install dependencies
          run: |
            python -m pip install --upgrade pip
            pip install cmake pico-sdk

        - name: Build Pico Project
          run: |
            mkdir build
            cd build
            cmake -DPICO_SDK_PATH=/opt/pico-sdk -DDEBUG_ON_PICO=ON ..
            make

        - name: Upload Artifact
          uses: actions/upload-artifact@v3
          with:
            name: pico-project
            path: build/*.uf2
